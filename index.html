<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0b0b0c" />
  <title>ALMU√ë√âCAR 38 ‚Äî Private Residences</title>
  <meta name="description" content="ALMU√ë√âCAR 38 ‚Äî Private access. 38 exclusive residences on Costa Tropical." />
  
  <!-- Open Graph -->
  <meta property="og:title" content="ALMU√ë√âCAR 38 ‚Äî Private Residences" />
  <meta property="og:description" content="38 exklusive Residenzen an der Costa Tropical. Zugang nur auf Anfrage." />
  <meta property="og:image" content="https://almunecar38.com/og-image.jpg" />
  <meta property="og:url" content="https://almunecar38.com" />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="de_DE" />
  <meta property="og:locale:alternate" content="en_GB" />
  <meta property="og:locale:alternate" content="es_ES" />
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="ALMU√ë√âCAR 38 ‚Äî Private Residences" />
  <meta name="twitter:description" content="38 exklusive Residenzen an der Costa Tropical." />
  <meta name="twitter:image" content="https://almunecar38.com/og-image.jpg" />

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3Eüèõ%3C/text%3E%3C/svg%3E" />
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b0b0c;
      --text:#e9e7e2;
      --muted:rgba(233,231,226,.55);
      --muted2:rgba(233,231,226,.30);
      --gold:#c9a76a;
      --stroke:rgba(233,231,226,.22);
      --strokeGold:rgba(201,167,106,.38);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      overflow-x:hidden;
    }

    /* Background mood */
    .bg-wrap{position:fixed; inset:0; pointer-events:none; z-index:0;}
    .vignette{
      position:absolute; inset:-20%;
      background:
        radial-gradient(1200px 700px at 55% 38%, rgba(201,167,106,.09), transparent 60%),
        radial-gradient(900px 600px at 30% 70%, rgba(233,231,226,.05), transparent 62%),
        radial-gradient(800px 500px at 78% 68%, rgba(201,167,106,.06), transparent 58%),
        radial-gradient(1500px 1000px at 50% 50%, rgba(0,0,0,0), rgba(0,0,0,.70) 70%, rgba(0,0,0,.92) 100%);
      opacity:.96;
    }
    .fog{
      position:absolute; inset:-20%;
      background:
        radial-gradient(550px 380px at 25% 40%, rgba(233,231,226,.055), transparent 65%),
        radial-gradient(750px 480px at 70% 55%, rgba(233,231,226,.040), transparent 68%),
        radial-gradient(950px 650px at 50% 80%, rgba(201,167,106,.038), transparent 70%);
      animation:fogMove 18s ease-in-out infinite alternate;
      filter: blur(0.2px);
    }
    @keyframes fogMove{
      from{transform:translate3d(-1.5%, -1%, 0) scale(1.02)}
      to{transform:translate3d(1.5%, 1%, 0) scale(1.04)}
    }
    .grain{
      position:absolute; inset:0;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='280' height='280'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='280' height='280' filter='url(%23n)' opacity='.22'/%3E%3C/svg%3E");
      background-size:280px 280px;
      mix-blend-mode: overlay;
      opacity:.25;
    }

    /* Floating background words */
    .float-words{position:absolute; inset:0; opacity:.86;}
    .float-word{
      position:absolute;
      font-family:"Cormorant Garamond", serif;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:rgba(233,231,226,.075);
      font-size:clamp(16px, 2.2vw, 28px);
      opacity:0;
      transform: translateY(10px);
      animation: wordFade 9s ease-in-out infinite;
      filter: drop-shadow(0 16px 40px rgba(0,0,0,.35));
      white-space:nowrap;
    }
    .float-word.gold{ color: rgba(201,167,106,.115); }
    @keyframes wordFade{
      0%{opacity:0; transform:translateY(10px)}
      18%{opacity:.92; transform:translateY(0)}
      55%{opacity:.92; transform:translateY(0)}
      78%{opacity:0; transform:translateY(-10px)}
      100%{opacity:0; transform:translateY(-10px)}
    }

    /* Language buttons */
    .lang{
      position:fixed;
      top:18px; right:18px;
      z-index:5;
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      gap:10px;
      width:min(420px, calc(100vw - 36px));
      user-select:none;
    }
    .lang button{
      appearance:none;
      border:1px solid rgba(233,231,226,.22);
      background: rgba(0,0,0,.12);
      color: rgba(233,231,226,.70);
      padding:10px 0;
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      border-radius:0;
      cursor:pointer;
      transition: border-color .2s ease, color .2s ease, background .2s ease;
    }
    .lang button.active{
      border-color: var(--strokeGold);
      color: var(--gold);
      background: rgba(201,167,106,.08);
    }

    /* Center card */
    .wrap{
      position:relative;
      z-index:2;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:32px 18px;
    }
    .card{
      width:min(560px, 92vw);
      text-align:center;
      padding:28px 20px 22px;
      border-radius:22px;
      background: linear-gradient(180deg, rgba(15,15,18,.38), rgba(15,15,18,.12));
      box-shadow: 0 40px 120px rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(233,231,226,.10);
    }

    .num{
      font-family:"Cormorant Garamond", serif;
      font-weight:300;
      font-size: clamp(72px, 13vw, 140px);
      line-height:1;
      margin: 6px 0 6px;
    }
    .place{
      margin:0 0 2px;
      font-family:"Cormorant Garamond", serif;
      font-weight:400;
      letter-spacing:.06em;
      text-transform:uppercase;
      color: rgba(233,231,226,.92);
      font-size: clamp(22px, 4vw, 34px);
    }
    .sub{
      margin:0 0 8px;
      letter-spacing:.36em;
      text-transform:uppercase;
      color: rgba(233,231,226,.45);
      font-size:12px;
    }

    /* Availability counter */
    .availability{
      display: inline-flex;
      align-items: center;
      gap: 8px;
      margin: 0 0 18px;
      padding: 8px 16px;
      border: 1px solid rgba(201,167,106,.25);
      background: rgba(201,167,106,.06);
      font-size: 11px;
      letter-spacing: .18em;
      text-transform: uppercase;
      color: var(--gold);
    }
    .availability .dot{
      width: 6px;
      height: 6px;
      background: var(--gold);
      border-radius: 50%;
      animation: pulse 2s ease-in-out infinite;
    }
    @keyframes pulse{
      0%, 100%{ opacity: 1; }
      50%{ opacity: .4; }
    }

    .copy{
      font-family:"Cormorant Garamond", serif;
      font-weight:300;
      font-size: clamp(20px, 3.2vw, 28px);
      line-height:1.6;
      color: rgba(233,231,226,.88);
      margin: 0 auto 18px;
      max-width: 450px;
      min-height: 96px;
      transition: opacity .45s ease;
    }
    .hint{
      margin: 18px 0 10px;
      font-size:11px;
      letter-spacing:.34em;
      text-transform:uppercase;
      color: rgba(233,231,226,.35);
    }

    form{
      display:flex;
      flex-direction:column;
      gap:12px;
      margin: 6px auto 10px;
      max-width: 420px;
    }
    input{
      width:100%;
      padding:16px 16px;
      border-radius:0;
      border:1px solid rgba(233,231,226,.22);
      background: rgba(0,0,0,.10);
      color: rgba(233,231,226,.92);
      outline:none;
      font-size:14px;
      letter-spacing:.02em;
    }
    input::placeholder{color: rgba(233,231,226,.35)}
    input:focus{border-color: rgba(201,167,106,.40)}

    button.cta{
      width:100%;
      padding:16px 16px;
      border-radius:0;
      border:1px solid rgba(233,231,226,.22);
      background: transparent;
      color: rgba(233,231,226,.75);
      font-size:12px;
      letter-spacing:.28em;
      text-transform:uppercase;
      cursor:pointer;
      transition: border-color .2s ease, color .2s ease, background .2s ease;
    }
    button.cta:hover{
      border-color: rgba(201,167,106,.45);
      color: rgba(201,167,106,.95);
      background: rgba(201,167,106,.06);
    }
    button.cta:disabled{
      opacity: .5;
      cursor: not-allowed;
    }

    /* Expandable form */
    .cta-trigger{
      max-width: 420px;
      margin: 6px auto 10px;
    }
    .cta-trigger.hidden{
      display: none;
    }
    .form-expandable{
      display:flex;
      flex-direction:column;
      gap:12px;
      margin: 6px auto 10px;
      max-width: 420px;
      max-height: 0;
      overflow: hidden;
      opacity: 0;
      transition: max-height .5s ease, opacity .4s ease, margin .4s ease;
    }
    .form-expandable.expanded{
      max-height: 300px;
      opacity: 1;
    }

    .fine{
      margin: 10px 0 0;
      font-size:12px;
      color: rgba(233,231,226,.40);
    }
    .fine strong{color: rgba(233,231,226,.68); font-weight:500}

    /* Trust badges */
    .trust{
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 16px;
      margin: 16px 0 0;
      padding: 14px 0 0;
      border-top: 1px solid rgba(233,231,226,.08);
    }
    .trust-item{
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 10px;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: rgba(233,231,226,.35);
    }
    .trust-item svg{
      width: 14px;
      height: 14px;
      opacity: .5;
    }

    footer{
      position:fixed;
      bottom:18px;
      left:0; right:0;
      z-index:4;
      display:flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      pointer-events:none;
    }
    footer .brand{
      font-size:11px;
      letter-spacing:.44em;
      text-transform:uppercase;
      color: rgba(233,231,226,.22);
    }
    footer .partner{
      font-size: 9px;
      letter-spacing: .2em;
      text-transform: uppercase;
      color: rgba(233,231,226,.15);
    }

    /* Success Modal */
    .modal-overlay{
      position: fixed;
      inset: 0;
      z-index: 100;
      background: rgba(11,11,12,.92);
      backdrop-filter: blur(12px);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity .4s ease, visibility .4s ease;
    }
    .modal-overlay.active{
      opacity: 1;
      visibility: visible;
    }
    .modal{
      width: min(480px, 90vw);
      padding: 40px 32px;
      text-align: center;
      border: 1px solid rgba(201,167,106,.25);
      background: linear-gradient(180deg, rgba(20,20,24,.95), rgba(15,15,18,.98));
      transform: translateY(20px) scale(.96);
      transition: transform .4s ease;
    }
    .modal-overlay.active .modal{
      transform: translateY(0) scale(1);
    }
    .modal-icon{
      width: 64px;
      height: 64px;
      margin: 0 auto 20px;
      border: 1px solid var(--strokeGold);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gold);
    }
    .modal-title{
      font-family: "Cormorant Garamond", serif;
      font-size: 28px;
      font-weight: 400;
      margin: 0 0 12px;
      color: var(--text);
    }
    .modal-text{
      font-size: 14px;
      line-height: 1.7;
      color: rgba(233,231,226,.65);
      margin: 0 0 24px;
    }
    .modal-close{
      appearance: none;
      border: 1px solid rgba(233,231,226,.22);
      background: transparent;
      color: rgba(233,231,226,.65);
      padding: 14px 32px;
      font-size: 11px;
      letter-spacing: .24em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all .2s ease;
    }
    .modal-close:hover{
      border-color: rgba(201,167,106,.45);
      color: var(--gold);
    }

    /* Cookie Consent */
    .cookie-banner{
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 90;
      padding: 16px 20px;
      background: rgba(15,15,18,.96);
      border-top: 1px solid rgba(233,231,226,.10);
      backdrop-filter: blur(10px);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      flex-wrap: wrap;
      transform: translateY(100%);
      transition: transform .4s ease;
    }
    .cookie-banner.active{
      transform: translateY(0);
    }
    .cookie-text{
      font-size: 12px;
      color: rgba(233,231,226,.6);
      max-width: 600px;
    }
    .cookie-text a{
      color: rgba(233,231,226,.8);
      text-decoration: underline;
    }
    .cookie-buttons{
      display: flex;
      gap: 10px;
    }
    .cookie-btn{
      appearance: none;
      border: 1px solid rgba(233,231,226,.22);
      background: transparent;
      color: rgba(233,231,226,.7);
      padding: 10px 20px;
      font-size: 10px;
      letter-spacing: .16em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all .2s ease;
    }
    .cookie-btn.accept{
      border-color: var(--strokeGold);
      color: var(--gold);
      background: rgba(201,167,106,.08);
    }
    .cookie-btn:hover{
      border-color: rgba(201,167,106,.5);
      color: var(--gold);
    }

    /* WhatsApp Floating Button */
    .whatsapp-float{
      position: fixed;
      bottom: 24px;
      right: 24px;
      z-index: 80;
      width: 56px;
      height: 56px;
      background: #25D366;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 20px rgba(37, 211, 102, .4);
      cursor: pointer;
      transition: transform .2s ease, box-shadow .2s ease;
      text-decoration: none;
    }
    .whatsapp-float:hover{
      transform: scale(1.1);
      box-shadow: 0 6px 28px rgba(37, 211, 102, .5);
    }
    .whatsapp-float svg{
      width: 28px;
      height: 28px;
      fill: #fff;
    }
    .whatsapp-tooltip{
      position: absolute;
      right: 68px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(15,15,18,.95);
      border: 1px solid rgba(233,231,226,.15);
      padding: 10px 14px;
      font-size: 12px;
      color: var(--text);
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: opacity .2s ease, visibility .2s ease;
    }
    .whatsapp-float:hover .whatsapp-tooltip{
      opacity: 1;
      visibility: visible;
    }

    /* Exit-Intent Popup */
    .exit-overlay{
      position: fixed;
      inset: 0;
      z-index: 110;
      background: rgba(11,11,12,.94);
      backdrop-filter: blur(14px);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity .4s ease, visibility .4s ease;
    }
    .exit-overlay.active{
      opacity: 1;
      visibility: visible;
    }
    .exit-popup{
      width: min(520px, 92vw);
      padding: 44px 36px;
      text-align: center;
      border: 1px solid rgba(201,167,106,.30);
      background: linear-gradient(180deg, rgba(20,20,24,.97), rgba(12,12,15,.99));
      transform: translateY(24px) scale(.95);
      transition: transform .4s ease;
    }
    .exit-overlay.active .exit-popup{
      transform: translateY(0) scale(1);
    }
    .exit-close{
      position: absolute;
      top: 16px;
      right: 16px;
      width: 32px;
      height: 32px;
      background: none;
      border: none;
      color: rgba(233,231,226,.5);
      cursor: pointer;
      font-size: 24px;
      line-height: 1;
    }
    .exit-close:hover{ color: var(--gold); }
    .exit-icon{
      width: 52px;
      height: 52px;
      margin: 0 auto 18px;
      border: 1px solid var(--strokeGold);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--gold);
    }
    .exit-title{
      font-family: "Cormorant Garamond", serif;
      font-size: 26px;
      font-weight: 400;
      margin: 0 0 10px;
      color: var(--text);
    }
    .exit-text{
      font-size: 14px;
      line-height: 1.7;
      color: rgba(233,231,226,.60);
      margin: 0 0 22px;
    }
    .exit-form{
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-width: 360px;
      margin: 0 auto;
    }
    .exit-form input{
      width: 100%;
      padding: 14px 16px;
      border: 1px solid rgba(233,231,226,.22);
      background: rgba(0,0,0,.15);
      color: var(--text);
      font-size: 14px;
    }
    .exit-form input::placeholder{ color: rgba(233,231,226,.35); }
    .exit-form input:focus{ border-color: rgba(201,167,106,.45); outline: none; }
    .exit-form button{
      padding: 14px;
      border: 1px solid var(--strokeGold);
      background: rgba(201,167,106,.12);
      color: var(--gold);
      font-size: 11px;
      letter-spacing: .22em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all .2s ease;
    }
    .exit-form button:hover{
      background: rgba(201,167,106,.20);
      border-color: var(--gold);
    }
    .exit-skip{
      margin-top: 14px;
      font-size: 11px;
      color: rgba(233,231,226,.35);
      cursor: pointer;
    }
    .exit-skip:hover{ color: rgba(233,231,226,.55); }

    @media (max-width:520px){
      .lang{grid-template-columns: repeat(3, 1fr); width:210px}
      .trust{ flex-direction: column; gap: 8px; }
    }
    @media (max-width:420px){
      .card{padding:24px 16px 18px}
      .copy{min-height: 110px;}
      .cookie-banner{ flex-direction: column; text-align: center; }
    }
  </style>
</head>

<body>
  <div class="bg-wrap" aria-hidden="true">
    <div class="vignette"></div>
    <div class="fog"></div>
    <div class="grain"></div>

    <div class="float-words" id="floatWords">
      <div class="float-word gold" style="left:10%; top:18%; animation-delay:0s;">38 RESIDENCES</div>
      <div class="float-word" style="left:62%; top:22%; animation-delay:1.2s;">SEA VIEW</div>
      <div class="float-word" style="left:14%; top:46%; animation-delay:2.4s;">AB 250.000 ‚Ç¨</div>
      <div class="float-word gold" style="left:58%; top:52%; animation-delay:3.6s;">10 MONATE BAUZEIT</div>
      <div class="float-word" style="left:20%; top:72%; animation-delay:4.8s;">LOW TECH RISK</div>
      <div class="float-word gold" style="left:56%; top:76%; animation-delay:6s;">ALMU√ë√âCAR</div>
    </div>
  </div>

  <div class="lang" role="group" aria-label="Language switcher">
    <button type="button" class="active" data-lang="de">DEU</button>
    <button type="button" data-lang="en">ENG</button>
    <button type="button" data-lang="es">ESP</button>
    <button type="button" data-lang="sv">SWE</button>
    <button type="button" data-lang="fi">FIN</button>
  </div>

  <main class="wrap">
    <section class="card">
      <div class="num" aria-label="38">38</div>
      <p class="place">ALMU√ë√âCAR</p>
      <p class="sub" id="subline">COSTA TROPICAL ¬∑ PRIVATE RESIDENCES</p>

      <!-- Availability counter -->
      <div class="availability" id="availability">
        <span class="dot"></span>
        <span id="availText">14 VON 38 VERF√úGBAR</span>
      </div>

      <p class="copy" id="headline">
        Manche Orte teilt man nicht.<br/>
        Manche Chancen auch nicht.
      </p>

      <div class="hint" id="hint">INTERESSE HINTERLEGEN</div>

      <!-- Collapsed CTA button -->
      <button class="cta cta-trigger" type="button" id="ctaTrigger">ZUGANG ANFORDERN</button>

      <!-- Expandable form -->
      <form class="form-expandable" id="interestForm">
        <input id="name" name="name" type="text" placeholder="Name" autocomplete="name" required />
        <input id="email" name="email" type="email" placeholder="E-Mail" autocomplete="email" required />
        <input id="phone" name="phone" type="tel" placeholder="Telefon (optional)" autocomplete="tel" />
        <button class="cta" type="submit" id="cta">ABSENDEN</button>
      </form>

      <p class="fine" id="fine">
        Zugang nur auf Anfrage. <strong>Diskretion</strong> garantiert.
      </p>

      <!-- Trust badges -->
      <div class="trust">
        <div class="trust-item" id="trust1">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </svg>
          <span>10 Monate Bauzeit</span>
        </div>
        <div class="trust-item" id="trust2">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="1" x2="12" y2="23"/>
            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
          </svg>
          <span>Ab 250.000 ‚Ç¨</span>
        </div>
        <div class="trust-item" id="trust3">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 12l2 2 4-4"/>
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          </svg>
          <span>Licencia validada</span>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="brand">almunecar38.com</div>
    <div class="partner" id="partner">Ein Projekt von Costa Tropical Investments</div>
  </footer>

  <!-- Success Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <div class="modal-icon">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 6L9 17l-5-5"/>
        </svg>
      </div>
      <h2 class="modal-title" id="modalTitle">Anfrage erhalten</h2>
      <p class="modal-text" id="modalText">
        Vielen Dank f√ºr Ihr Interesse. Wir pr√ºfen Ihre Anfrage und melden uns innerhalb von 48 Stunden mit exklusiven Informationen.
      </p>
      <button class="modal-close" id="modalClose">SCHLIE√üEN</button>
    </div>
  </div>

  <!-- Cookie Consent -->
  <div class="cookie-banner" id="cookieBanner">
    <p class="cookie-text" id="cookieText">
      Diese Website verwendet Cookies, um Ihre Erfahrung zu verbessern und anonyme Nutzungsstatistiken zu erfassen.
    </p>
    <div class="cookie-buttons">
      <button class="cookie-btn" id="cookieDecline">ABLEHNEN</button>
      <button class="cookie-btn accept" id="cookieAccept">AKZEPTIEREN</button>
    </div>
  </div>

  <!-- WhatsApp Floating Button -->
  <a href="https://wa.me/34600000000?text=Hallo%2C%20ich%20interessiere%20mich%20f%C3%BCr%20ALMU%C3%91%C3%89CAR%2038"
     class="whatsapp-float"
     id="whatsappBtn"
     target="_blank"
     rel="noopener noreferrer"
     aria-label="WhatsApp">
    <span class="whatsapp-tooltip" id="whatsappTooltip">Direkt auf WhatsApp schreiben</span>
    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
    </svg>
  </a>

  <!-- Exit-Intent Popup (Lead Magnet) -->
  <div class="exit-overlay" id="exitOverlay">
    <div class="exit-popup">
      <button class="exit-close" id="exitClose">&times;</button>
      <div class="exit-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" y1="13" x2="8" y2="13"/>
          <line x1="16" y1="17" x2="8" y2="17"/>
          <polyline points="10 9 9 9 8 9"/>
        </svg>
      </div>
      <h3 class="exit-title" id="exitTitle">Kostenloses Expos√©</h3>
      <p class="exit-text" id="exitText">
        Erhalten Sie unser exklusives PDF mit Grundrissen, Preisen und allen Details zu den 38 Residenzen.
      </p>
      <form class="exit-form" id="exitForm">
        <input type="email" id="exitEmail" placeholder="Ihre E-Mail-Adresse" required />
        <button type="submit" id="exitSubmit">EXPOS√â ANFORDERN</button>
      </form>
      <p class="exit-skip" id="exitSkip">Nein danke, ich schaue nur</p>
    </div>
  </div>

  <!-- Analytics (loads only after consent) -->
  <script>
    // ============================================
    // GOOGLE ANALYTICS 4 CONFIGURATION
    // ============================================
    // Ersetze 'G-XXXXXXXXXX' mit deiner GA4 Measurement ID
    // Zu finden unter: GA4 > Admin > Data Streams > Web

    const GA4_MEASUREMENT_ID = 'G-KL4X5ZYGME';

    function loadAnalytics(){
      if (GA4_MEASUREMENT_ID === 'G-XXXXXXXXXX') {
        console.log('Analytics: Bitte GA4_MEASUREMENT_ID konfigurieren');
        return;
      }

      // Google Analytics 4 laden
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', GA4_MEASUREMENT_ID);

      var script = document.createElement('script');
      script.src = 'https://www.googletagmanager.com/gtag/js?id=' + GA4_MEASUREMENT_ID;
      script.async = true;
      document.head.appendChild(script);

      console.log('Analytics loaded:', GA4_MEASUREMENT_ID);
    }

    // Analytics Event Helper
    function trackEvent(eventName, params = {}) {
      if (typeof gtag !== 'undefined') {
        gtag('event', eventName, params);
      }
    }
  </script>

  <script>
    const content = {
      de: {
        htmlLang: "de",
        subline: "COSTA TROPICAL ¬∑ PRIVATE RESIDENCES",
        availability: "14 VON 38 VERF√úGBAR",
        hint: "INTERESSE HINTERLEGEN",
        namePH: "Name",
        emailPH: "E-Mail",
        phonePH: "Telefon (optional)",
        ctaTrigger: "ZUGANG ANFORDERN",
        cta: "ABSENDEN",
        fine: "Zugang nur auf Anfrage. <strong>Diskretion</strong> garantiert.",
        trust1: "10 Monate Bauzeit",
        trust2: "Ab 250.000 ‚Ç¨",
        trust3: "Lizenz validiert",
        partner: "Ein Projekt von Costa Tropical Investments",
        modalTitle: "Anfrage erhalten",
        modalText: "Vielen Dank f√ºr Ihr Interesse. Wir pr√ºfen Ihre Anfrage und melden uns innerhalb von 48 Stunden mit exklusiven Informationen.",
        modalClose: "SCHLIE√üEN",
        cookieText: "Diese Website verwendet Cookies, um Ihre Erfahrung zu verbessern und anonyme Nutzungsstatistiken zu erfassen.",
        cookieDecline: "ABLEHNEN",
        cookieAccept: "AKZEPTIEREN",
        bgWords: ["38 RESIDENCES","MEERBLICK","AB 250.000 ‚Ç¨","10 MONATE BAUZEIT","NIEDRIGES RISIKO","ALMU√ë√âCAR"],
        headlineLoop: [
          "Manche Orte teilt man nicht.<br/>Manche Chancen auch nicht.",
          "38 Residenzen.<br/>F√ºr Menschen, die vorausdenken.",
          "Ab 250.000 ‚Ç¨.<br/>Ihr Einstieg ins Mittelmeer.",
          "Ihr R√ºckzugsort.<br/>300 Sonnentage im Jahr.",
          "Nur 10 Monate Bauzeit.<br/>Schneller am Ziel.",
          "Zwischen Bergen und Meer.<br/>Ihr n√§chstes Kapitel."
        ],
        // WhatsApp & Exit-Intent
        whatsappTooltip: "Direkt auf WhatsApp schreiben",
        whatsappMsg: "Hallo, ich interessiere mich f√ºr ALMU√ë√âCAR 38",
        exitTitle: "Kostenloses Expos√©",
        exitText: "Erhalten Sie unser exklusives PDF mit Grundrissen, Preisen und allen Details zu den 38 Residenzen.",
        exitPlaceholder: "Ihre E-Mail-Adresse",
        exitSubmit: "EXPOS√â ANFORDERN",
        exitSkip: "Nein danke, ich schaue nur"
      },
      en: {
        htmlLang: "en",
        subline: "COSTA TROPICAL ¬∑ PRIVATE RESIDENCES",
        availability: "14 OF 38 AVAILABLE",
        hint: "REQUEST ACCESS",
        namePH: "Name",
        emailPH: "E-mail",
        phonePH: "Phone (optional)",
        ctaTrigger: "REQUEST ACCESS",
        cta: "SUBMIT",
        fine: "Access by request only. <strong>Discretion</strong> guaranteed.",
        trust1: "10 months build time",
        trust2: "From ‚Ç¨250,000",
        trust3: "License validated",
        partner: "A project by Costa Tropical Investments",
        modalTitle: "Request received",
        modalText: "Thank you for your interest. We will review your request and contact you within 48 hours with exclusive information.",
        modalClose: "CLOSE",
        cookieText: "This website uses cookies to improve your experience and collect anonymous usage statistics.",
        cookieDecline: "DECLINE",
        cookieAccept: "ACCEPT",
        bgWords: ["38 RESIDENCES","SEA VIEW","FROM ‚Ç¨250,000","10 MONTHS BUILD","LOW RISK","ALMU√ë√âCAR"],
        headlineLoop: [
          "Some places aren't shared.<br/>Neither are certain opportunities.",
          "38 residences.<br/>For those who think ahead.",
          "From ‚Ç¨250,000.<br/>Your gateway to the Mediterranean.",
          "Your retreat.<br/>300 days of sunshine.",
          "Only 10 months build time.<br/>Faster to your goal.",
          "Between mountains and sea.<br/>Your next chapter."
        ],
        whatsappTooltip: "Message us on WhatsApp",
        whatsappMsg: "Hello, I'm interested in ALMU√ë√âCAR 38",
        exitTitle: "Free Brochure",
        exitText: "Get our exclusive PDF with floor plans, prices and all details about the 38 residences.",
        exitPlaceholder: "Your email address",
        exitSubmit: "GET BROCHURE",
        exitSkip: "No thanks, just browsing"
      },
      es: {
        htmlLang: "es",
        subline: "COSTA TROPICAL ¬∑ RESIDENCIAS PRIVADAS",
        availability: "14 DE 38 DISPONIBLES",
        hint: "SOLICITAR ACCESO",
        namePH: "Nombre",
        emailPH: "E-mail",
        phonePH: "Tel√©fono (opcional)",
        ctaTrigger: "SOLICITAR ACCESO",
        cta: "ENVIAR",
        fine: "Acceso solo bajo solicitud. <strong>Discreci√≥n</strong> garantizada.",
        trust1: "10 meses de obra",
        trust2: "Desde 250.000 ‚Ç¨",
        trust3: "Licencia validada",
        partner: "Un proyecto de Costa Tropical Investments",
        modalTitle: "Solicitud recibida",
        modalText: "Gracias por su inter√©s. Revisaremos su solicitud y le contactaremos en 48 horas con informaci√≥n exclusiva.",
        modalClose: "CERRAR",
        cookieText: "Este sitio web utiliza cookies para mejorar su experiencia y recopilar estad√≠sticas de uso an√≥nimas.",
        cookieDecline: "RECHAZAR",
        cookieAccept: "ACEPTAR",
        bgWords: ["38 RESIDENCIAS","VISTAS AL MAR","DESDE 250.000 ‚Ç¨","10 MESES DE OBRA","BAJO RIESGO","ALMU√ë√âCAR"],
        headlineLoop: [
          "Algunos lugares no se comparten.<br/>Algunas oportunidades tampoco.",
          "38 residencias.<br/>Para quienes se adelantan.",
          "Desde 250.000 ‚Ç¨.<br/>Tu entrada al Mediterr√°neo.",
          "Tu refugio.<br/>300 d√≠as de sol al a√±o.",
          "Solo 10 meses de obra.<br/>M√°s r√°pido a tu meta.",
          "Entre monta√±as y mar.<br/>Tu pr√≥ximo cap√≠tulo."
        ],
        whatsappTooltip: "Escr√≠benos por WhatsApp",
        whatsappMsg: "Hola, me interesa ALMU√ë√âCAR 38",
        exitTitle: "Folleto Gratuito",
        exitText: "Reciba nuestro PDF exclusivo con planos, precios y todos los detalles de las 38 residencias.",
        exitPlaceholder: "Su correo electr√≥nico",
        exitSubmit: "SOLICITAR FOLLETO",
        exitSkip: "No gracias, solo miro"
      },
      sv: {
        htmlLang: "sv",
        subline: "COSTA TROPICAL ¬∑ PRIVATA BOST√ÑDER",
        availability: "14 AV 38 TILLG√ÑNGLIGA",
        hint: "BEG√ÑR √ÖTKOMST",
        namePH: "Namn",
        emailPH: "E-post",
        phonePH: "Telefon (valfritt)",
        ctaTrigger: "BEG√ÑR √ÖTKOMST",
        cta: "SKICKA",
        fine: "√Ötkomst endast p√• beg√§ran. <strong>Diskretion</strong> garanteras.",
        trust1: "10 m√•naders byggtid",
        trust2: "Fr√•n 250 000 ‚Ç¨",
        trust3: "Licens validerad",
        partner: "Ett projekt av Costa Tropical Investments",
        modalTitle: "F√∂rfr√•gan mottagen",
        modalText: "Tack f√∂r ditt intresse. Vi granskar din f√∂rfr√•gan och kontaktar dig inom 48 timmar med exklusiv information.",
        modalClose: "ST√ÑNG",
        cookieText: "Denna webbplats anv√§nder cookies f√∂r att f√∂rb√§ttra din upplevelse och samla in anonym anv√§ndningsstatistik.",
        cookieDecline: "AVVISA",
        cookieAccept: "ACCEPTERA",
        bgWords: ["38 BOST√ÑDER","HAVSUTSIKT","FR√ÖN 250 000 ‚Ç¨","10 M√ÖNADERS BYGGTID","L√ÖG RISK","ALMU√ë√âCAR"],
        headlineLoop: [
          "Vissa platser delar man inte.<br/>Inte heller vissa m√∂jligheter.",
          "38 bost√§der.<br/>F√∂r dig som t√§nker fram√•t.",
          "Fr√•n 250 000 ‚Ç¨.<br/>Din ing√•ng till Medelhavet.",
          "Din tillflyktsort.<br/>300 soldagar om √•ret.",
          "Endast 10 m√•naders byggtid.<br/>Snabbare till m√•let.",
          "Mellan berg och hav.<br/>Ditt n√§sta kapitel."
        ],
        whatsappTooltip: "Skriv till oss p√• WhatsApp",
        whatsappMsg: "Hej, jag √§r intresserad av ALMU√ë√âCAR 38",
        exitTitle: "Gratis Broschyr",
        exitText: "F√• v√•r exklusiva PDF med planritningar, priser och alla detaljer om de 38 bost√§derna.",
        exitPlaceholder: "Din e-postadress",
        exitSubmit: "H√ÑMTA BROSCHYR",
        exitSkip: "Nej tack, jag tittar bara"
      },
      fi: {
        htmlLang: "fi",
        subline: "COSTA TROPICAL ¬∑ YKSITYISET ASUNNOT",
        availability: "14/38 SAATAVILLA",
        hint: "PYYD√Ñ P√Ñ√ÑSY",
        namePH: "Nimi",
        emailPH: "S√§hk√∂posti",
        phonePH: "Puhelin (valinnainen)",
        ctaTrigger: "PYYD√Ñ P√Ñ√ÑSY",
        cta: "L√ÑHET√Ñ",
        fine: "P√§√§sy vain pyynn√∂st√§. <strong>Hienotunteisuus</strong> taataan.",
        trust1: "10 kk rakennusaika",
        trust2: "Alk. 250 000 ‚Ç¨",
        trust3: "Lisenssi validoitu",
        partner: "Costa Tropical Investmentsin projekti",
        modalTitle: "Pyynt√∂ vastaanotettu",
        modalText: "Kiitos mielenkiinnostasi. K√§sittelemme pyynt√∂si ja otamme sinuun yhteytt√§ 48 tunnin kuluessa eksklusiivisilla tiedoilla.",
        modalClose: "SULJE",
        cookieText: "T√§m√§ sivusto k√§ytt√§√§ ev√§steit√§ parantaakseen kokemustasi ja ker√§t√§kseen nimett√∂mi√§ k√§ytt√∂tilastoja.",
        cookieDecline: "HYLK√Ñ√Ñ",
        cookieAccept: "HYV√ÑKSY",
        bgWords: ["38 ASUNTOA","MERIN√ÑK√ñALA","ALK. 250 000 ‚Ç¨","10 KK RAKENNUSAIKA","MATALA RISKI","ALMU√ë√âCAR"],
        headlineLoop: [
          "Kaikkia paikkoja ei jaeta.<br/>Eik√§ kaikkia mahdollisuuksia.",
          "38 asuntoa.<br/>Niille, jotka ajattelevat edell√§.",
          "Alkaen 250 000 ‚Ç¨.<br/>Porttisi V√§limerelle.",
          "Pakopaikkasi.<br/>300 aurinkop√§iv√§√§ vuodessa.",
          "Vain 10 kuukauden rakennusaika.<br/>Nopeammin perille.",
          "Vuorten ja meren v√§liss√§.<br/>Seuraava lukusi."
        ],
        whatsappTooltip: "Kirjoita meille WhatsAppissa",
        whatsappMsg: "Hei, olen kiinnostunut ALMU√ë√âCAR 38:sta",
        exitTitle: "Ilmainen Esite",
        exitText: "Saat eksklusiivisen PDF:n pohjapiirustuksilla, hinnoilla ja kaikilla tiedoilla 38 asunnosta.",
        exitPlaceholder: "S√§hk√∂postiosoitteesi",
        exitSubmit: "PYYD√Ñ ESITE",
        exitSkip: "Ei kiitos, vain katselen"
      }
    };

    const btns = document.querySelectorAll(".lang button[data-lang]");
    const subline = document.getElementById("subline");
    const availText = document.getElementById("availText");
    const headline = document.getElementById("headline");
    const hint = document.getElementById("hint");
    const nameInput = document.getElementById("name");
    const email = document.getElementById("email");
    const phone = document.getElementById("phone");
    const ctaTrigger = document.getElementById("ctaTrigger");
    const cta = document.getElementById("cta");
    const fine = document.getElementById("fine");
    const trust1 = document.getElementById("trust1").querySelector("span");
    const trust2 = document.getElementById("trust2").querySelector("span");
    const trust3 = document.getElementById("trust3").querySelector("span");
    const partner = document.getElementById("partner");
    const modalTitle = document.getElementById("modalTitle");
    const modalText = document.getElementById("modalText");
    const modalClose = document.getElementById("modalClose");
    const cookieText = document.getElementById("cookieText");
    const cookieDecline = document.getElementById("cookieDecline");
    const cookieAccept = document.getElementById("cookieAccept");
    const floatWords = document.querySelectorAll("#floatWords .float-word");
    const modalOverlay = document.getElementById("modalOverlay");
    const interestForm = document.getElementById("interestForm");
    const cookieBanner = document.getElementById("cookieBanner");

    let currentLang = "de";
    let loopIndex = 0;

    function setLang(lang){
      if(!content[lang]) return;
      currentLang = lang;
      loopIndex = 0;

      const t = content[lang];
      document.documentElement.lang = t.htmlLang;

      subline.textContent = t.subline;
      availText.textContent = t.availability;
      hint.textContent = t.hint;
      nameInput.placeholder = t.namePH;
      email.placeholder = t.emailPH;
      phone.placeholder = t.phonePH;
      ctaTrigger.textContent = t.ctaTrigger;
      cta.textContent = t.cta;
      fine.innerHTML = t.fine;
      trust1.textContent = t.trust1;
      trust2.textContent = t.trust2;
      trust3.textContent = t.trust3;
      partner.textContent = t.partner;
      modalTitle.textContent = t.modalTitle;
      modalText.textContent = t.modalText;
      modalClose.textContent = t.modalClose;
      cookieText.textContent = t.cookieText;
      cookieDecline.textContent = t.cookieDecline;
      cookieAccept.textContent = t.cookieAccept;

      headline.style.opacity = "0";
      setTimeout(() => {
        headline.innerHTML = t.headlineLoop[0];
        headline.style.opacity = "1";
      }, 220);

      const words = t.bgWords;
      floatWords.forEach((el, i) => { el.textContent = words[i] || el.textContent; });

      btns.forEach(b => b.classList.toggle("active", b.dataset.lang === lang));
      localStorage.setItem("am38_lang", lang);

      // Update WhatsApp & Exit-Intent texts
      const whatsappTooltip = document.getElementById("whatsappTooltip");
      const whatsappBtn = document.getElementById("whatsappBtn");
      const exitTitle = document.getElementById("exitTitle");
      const exitText = document.getElementById("exitText");
      const exitEmail = document.getElementById("exitEmail");
      const exitSubmit = document.getElementById("exitSubmit");
      const exitSkip = document.getElementById("exitSkip");

      if (whatsappTooltip) whatsappTooltip.textContent = t.whatsappTooltip;
      if (exitTitle) exitTitle.textContent = t.exitTitle;
      if (exitText) exitText.textContent = t.exitText;
      if (exitEmail) exitEmail.placeholder = t.exitPlaceholder;
      if (exitSubmit) exitSubmit.textContent = t.exitSubmit;
      if (exitSkip) exitSkip.textContent = t.exitSkip;

      // Update WhatsApp link with localized message
      if (whatsappBtn) {
        const waNumber = '34601180586'; // <- WHATSAPP NUMMER HIER √ÑNDERN
        const waMsg = encodeURIComponent(t.whatsappMsg);
        whatsappBtn.href = `https://wa.me/${waNumber}?text=${waMsg}`;
      }
    }

    btns.forEach(b => b.addEventListener("click", () => setLang(b.dataset.lang)));

    function rotateHeadline(){
      const t = content[currentLang];
      const list = t.headlineLoop;
      loopIndex = (loopIndex + 1) % list.length;
      headline.style.opacity = "0";
      setTimeout(() => {
        headline.innerHTML = list[loopIndex];
        headline.style.opacity = "1";
      }, 380);
    }

    setInterval(rotateHeadline, 8500);

    const stored = localStorage.getItem("am38_lang");
    setLang(stored && content[stored] ? stored : "de");

    // ============================================
    // GOOGLE SHEETS CONFIGURATION
    // ============================================
    // 1. Erstelle ein neues Google Sheet
    // 2. Gehe zu Extensions > Apps Script
    // 3. F√ºge den Code aus google-apps-script.js ein
    // 4. Deploy > New Deployment > Web App
    // 5. Execute as: Me, Access: Anyone
    // 6. Kopiere die Web App URL hier:
    
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx_b2498qw3T7rJgEwVqdy44O0I3IyR1L3tpG8x7JgqDqB8jxoIcKdDt6spMHQ4PlCg8Q/exec';

    // ============================================
    // UTM & PARTNER TRACKING
    // ============================================
    // Erfasst UTM-Parameter und Partner-Codes aus der URL
    // Beispiel: almunecar38.com/?ref=partner123&utm_source=instagram

    function getTrackingParams() {
      const params = new URLSearchParams(window.location.search);
      return {
        utm_source: params.get('utm_source') || '',
        utm_medium: params.get('utm_medium') || '',
        utm_campaign: params.get('utm_campaign') || '',
        utm_term: params.get('utm_term') || '',
        utm_content: params.get('utm_content') || '',
        ref: params.get('ref') || params.get('partner') || ''
      };
    }

    // Speichere Tracking-Daten in Session (bleibt erhalten bei Navigation)
    const trackingParams = getTrackingParams();
    if (trackingParams.ref) {
      sessionStorage.setItem('am38_ref', trackingParams.ref);
    }
    if (trackingParams.utm_source) {
      sessionStorage.setItem('am38_utm', JSON.stringify(trackingParams));
    }

    // Hole gespeicherte Tracking-Daten (falls User sp√§ter zur√ºckkommt)
    function getStoredTracking() {
      const storedRef = sessionStorage.getItem('am38_ref');
      const storedUtm = sessionStorage.getItem('am38_utm');
      const current = getTrackingParams();

      return {
        utm_source: current.utm_source || (storedUtm ? JSON.parse(storedUtm).utm_source : ''),
        utm_medium: current.utm_medium || (storedUtm ? JSON.parse(storedUtm).utm_medium : ''),
        utm_campaign: current.utm_campaign || (storedUtm ? JSON.parse(storedUtm).utm_campaign : ''),
        utm_term: current.utm_term || (storedUtm ? JSON.parse(storedUtm).utm_term : ''),
        utm_content: current.utm_content || (storedUtm ? JSON.parse(storedUtm).utm_content : ''),
        ref: current.ref || storedRef || ''
      };
    }

    async function saveToGoogleSheets(data) {
      const response = await fetch(GOOGLE_SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors', // Required for Google Apps Script
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
      });
      
      // no-cors doesn't return response, so we assume success
      return true;
    }

    // Form expand/collapse
    ctaTrigger.addEventListener("click", () => {
      ctaTrigger.classList.add("hidden");
      interestForm.classList.add("expanded");
      setTimeout(() => nameInput.focus(), 300);
    });

    // Form submission with Google Sheets
    interestForm.addEventListener("submit", async function(e){
      e.preventDefault();
      
      const tracking = getStoredTracking();
      const leadData = {
        timestamp: new Date().toISOString(),
        name: nameInput.value.trim(),
        email: email.value.trim(),
        phone: phone.value.trim() || '',
        language: currentLang,
        source: 'almunecar38',
        page: window.location.href,
        // UTM Tracking
        utm_source: tracking.utm_source,
        utm_medium: tracking.utm_medium,
        utm_campaign: tracking.utm_campaign,
        utm_term: tracking.utm_term,
        utm_content: tracking.utm_content,
        // Partner/Tippgeber
        referrer: tracking.ref
      };

      cta.disabled = true;
      cta.textContent = "...";

      try {
        await saveToGoogleSheets(leadData);
        trackEvent('lead_submitted', { source: 'main_form', language: currentLang });

        // Show success modal
        modalOverlay.classList.add("active");
        
        // Reset form
        nameInput.value = "";
        email.value = "";
        phone.value = "";
        interestForm.classList.remove("expanded");
        ctaTrigger.classList.remove("hidden");
        
      } catch(err){
        console.error(err);
        // Still show success (no-cors doesn't confirm)
        modalOverlay.classList.add("active");
        nameInput.value = "";
        email.value = "";
        phone.value = "";
        interestForm.classList.remove("expanded");
        ctaTrigger.classList.remove("hidden");
      }

      cta.disabled = false;
      cta.textContent = content[currentLang].cta;
    });

    // Modal close
    modalClose.addEventListener("click", () => {
      modalOverlay.classList.remove("active");
    });
    modalOverlay.addEventListener("click", (e) => {
      if(e.target === modalOverlay) modalOverlay.classList.remove("active");
    });

    // Cookie consent
    const cookieConsent = localStorage.getItem("am38_cookies");
    if(!cookieConsent){
      setTimeout(() => cookieBanner.classList.add("active"), 1500);
    } else if(cookieConsent === "accepted"){
      loadAnalytics();
    }

    cookieAccept.addEventListener("click", () => {
      localStorage.setItem("am38_cookies", "accepted");
      cookieBanner.classList.remove("active");
      loadAnalytics();
    });

    cookieDecline.addEventListener("click", () => {
      localStorage.setItem("am38_cookies", "declined");
      cookieBanner.classList.remove("active");
    });

    // ============================================
    // EXIT-INTENT POPUP
    // ============================================
    const exitOverlay = document.getElementById("exitOverlay");
    const exitClose = document.getElementById("exitClose");
    const exitForm = document.getElementById("exitForm");
    const exitEmailInput = document.getElementById("exitEmail");
    const exitSkipBtn = document.getElementById("exitSkip");
    let exitShown = sessionStorage.getItem("am38_exit_shown");

    function showExitPopup() {
      if (exitShown || modalOverlay.classList.contains("active")) return;
      exitOverlay.classList.add("active");
      exitShown = true;
      sessionStorage.setItem("am38_exit_shown", "true");
      trackEvent('exit_intent_shown');
    }

    function closeExitPopup() {
      exitOverlay.classList.remove("active");
    }

    // Exit-Intent Detection (Desktop: mouse leaves viewport top)
    document.addEventListener("mouseout", (e) => {
      if (e.clientY < 10 && e.relatedTarget === null) {
        showExitPopup();
      }
    });

    // Mobile: Show after 45 seconds if no interaction
    let mobileExitTimer;
    if ('ontouchstart' in window) {
      mobileExitTimer = setTimeout(() => {
        if (!exitShown && !interestForm.classList.contains("expanded")) {
          showExitPopup();
        }
      }, 45000);
    }

    // Close handlers
    exitClose.addEventListener("click", closeExitPopup);
    exitSkipBtn.addEventListener("click", () => {
      closeExitPopup();
      trackEvent('exit_intent_skipped');
    });
    exitOverlay.addEventListener("click", (e) => {
      if (e.target === exitOverlay) closeExitPopup();
    });

    // Exit form submission
    exitForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const tracking = getStoredTracking();
      const leadData = {
        timestamp: new Date().toISOString(),
        name: '',
        email: exitEmailInput.value.trim(),
        phone: '',
        language: currentLang,
        source: 'almunecar38_exit_popup',
        page: window.location.href,
        utm_source: tracking.utm_source,
        utm_medium: tracking.utm_medium,
        utm_campaign: tracking.utm_campaign,
        utm_term: tracking.utm_term,
        utm_content: tracking.utm_content,
        referrer: tracking.ref
      };

      const submitBtn = document.getElementById("exitSubmit");
      submitBtn.disabled = true;
      submitBtn.textContent = "...";

      try {
        await saveToGoogleSheets(leadData);
        trackEvent('exit_intent_converted', { method: 'email' });
        closeExitPopup();
        modalOverlay.classList.add("active");
        exitEmailInput.value = "";
      } catch (err) {
        console.error(err);
        closeExitPopup();
        modalOverlay.classList.add("active");
      }

      submitBtn.disabled = false;
      submitBtn.textContent = content[currentLang].exitSubmit;
    });

    // ============================================
    // WHATSAPP TRACKING
    // ============================================
    const whatsappBtn = document.getElementById("whatsappBtn");
    whatsappBtn.addEventListener("click", () => {
      trackEvent('whatsapp_click', { language: currentLang });
    });

  </script>
</body>
</html>